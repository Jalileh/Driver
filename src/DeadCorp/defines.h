#pragma once
#include <ntifs.h>
#include <ntddk.h> 
#include <iostream>
#include <stdio.h>
#include <cstring>

//#define DEBUG 

/*
?DEBUG MODE PRINT DISABLE FOR RElEASE */

#define DEBUG_SWITCH 1

#define AC_BOTH 1

#define AC_EAC 0

#define AC_BE 0


#define recast reinterpret_cast
#define Root "\\SystemRoot\\System32\\"
#define FAILURE 0

typedef unsigned char byte;
typedef unsigned char * byte_ptr;
typedef unsigned long long uint64;
typedef long long int64;
typedef  signed long long sint64;
typedef void * void_ptr;
typedef void * pvoid;
typedef unsigned long long * qword_ptr;

 
 
/*  hook found
byte Pattern[] = {0x48, 0x8B, 0x05, R, R, R, R, 0x48, 0x85, 0xC0, 0x74, 0x08, 0xFF, 0x15, R, R, R, R, 0xEB, 0x03, 0x41, 0x8B, 0xC6, 0x85, 0xC0, 0x78, 0x12, 0x48, 0x8B, 0x05, R, R, R, R, 0x48, 0x85, 0xC0, 0x74, 0x06, 0xFF, 0x15, R, R, R, R, 0x48, 0x8B, 0x05, R, R, R, R, 0x48, 0x85, 0xC0, 0x74, 0x08, 0xFF, 0x15, R, R, R, R, 0xEB, 0x03, 0x41, 0x8B, 0xC6, 0x85, 0xC0, 0x78, 0x15};


other hook 

 byte Pattern[] = {0x48, 0x8B, 0x05, R, R, R, R, 0x48, 0x85, 0xC0, 0x74, 0x0D, 0x48, 0x8B, 0x0D, R, R, R, R, 0xFF, 0x15, R, R, R, R, 0xE8, R, R, R, R, 0x48, 0x8D, 0x1D};

 THE TWO FASTEST DATAPTRS IN WIN32KBASE
 byte Pattern[] = {0x48, 0x8B, 0x05, R, R, R, R, 0x48, 0x85, 0xC0, 0x74, 0x22, 0xFF, 0x15};
byte Pattern[] = {0x48, 0x8B, 0x05, R, R, R, R, 0x45, 0x33, 0xFF, 0x48, 0x85, 0xC0, 0x74, 0x2C};


MORE 

  //byte Pattern1[] = {0x48,0x8B,0x05,R,R,R,R,0x48,0x85,0xC0,0x74,0x0E,0x48,0x8D,0x8C,0x24,0xF0,R,R,R};
  //byte Pattern3[] = {0x48,0x8B,0x05,R,R,R,R,0x48,0x85,0xC0,0x74,0x06,0xFF,0x15,R,R,R,R,0x48,0x39,0x7C,0x24,0x78};  
  //byte Pattern4[] = {0x48,0x8B,0x05,R,R,R,R,0x48,0x85,0xC0,0x74,0x4D,0xFF,0x15,R,R,R,R,0xEB,0x4A};
  //byte Pattern2[] = {0x48, 0x8B, 0x05, R, R, R, R, 0x45, 0x33, 0xFF, 0x48, 0x85, 0xC0, 0x74, 0x2C};


vm easy stack com
     byte Pattern5[] = {0x48,0x8B,0x05,R,R,R,R,0x41,0x8B,0xD8,0x48,0x8B,0xFA,0x48,0x8B,0xF1,0x48,0x85,0xC0,0x74,0x08,0xFF,0x15,R,R,R,R,0xEB,0x05,0xB8,0xBB,R,R,0xC0,0x85,0xC0,0x78,0x31, 0xE8, R, R, R, R, 0x85, 0xC0, 0x74};
 */

        
#define AOH_OBJHANDLER_MAX 4


#if DEBUG_SWITCH == 1
#define DEBUG
#endif

#if AC_BE == 1
#define BE
#endif

#if AC_EAC == 1
#define EAC
#endif

#if AC_BOTH == 1
#define EAC
#define BE
#endif